kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
containerdConfigPatches:
  - |-
    [plugins."io.containerd.grpc.v1.cri".registry]
      [plugins."io.containerd.grpc.v1.cri".registry.mirrors]
        [plugins."io.containerd.grpc.v1.cri".registry.mirrors."docker.io"]
          endpoint = [
            "https://dockerpull.com",
            "https://dockerproxy.1panel.live",
            "https://docker.m.daocloud.io",
            "https://registry-1.docker.io",
            "https://dockerhub.icu",
            "https://docker.mirrors.ustc.edu.cn"
          ]
nodes:
  - role: control-plane
    extraPortMappings:
      - containerPort: 80
        hostPort: 81
        protocol: TCP
      - containerPort: 443
        hostPort: 443
        protocol: TCP
  - role: worker
  - role: worker
  - role: worker
networking:
  # the default CNI will not be installed
  # disableDefaultCNI: true
  ipFamily: dual
  kubeProxyMode: "nftables"
  # podSubnet: 192.168.0.0/16 # set to Calico's default subnet
# kind create cluster --config=kind-cluster-config.yaml
# kubectl apply -f https://raw.githubusercontent.com/projectcalico/calico/v3.29.2/manifests/calico.yaml
